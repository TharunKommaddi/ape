
DECLARE
  v_count NUMBER := 0;
BEGIN
  INSERT INTO TA_CHARTER_BKNG_INTERFACE (
    UPLOADER_DATE, FILE_CODE, COSTING_CODE, RESERVATION_NO, DATE_OF_RESERVATION,
    TOURIST, MR_MRS, DATE_OF_BIRTH, PASSPORT, HOTEL, HOTEL_CODE,
    ROOM_CATEGORY, ROOM_CATEGORY_CODE, RATE_CATEGORY, SGL, DBL, TRP,
    TOTAL_NO_OF_PAX, NO_OF_ADULTS, NO_OF_CHILD, NO_OF_INFANTS,
    MEAL, MEAL_PLAN_CODE, FLIGHT_NAME, RETURN_FLIGHT, SERVICES_BY_PARTNER,
    STAY_START_DATE, STAY_END_DATE, FTO_CURRENCY, TAX_INCLUSIVE, FTO_AMOUNT
  )
  SELECT 
    SYSDATE, FILE_CODE, COSTING_CODE, RESERVATION_NO, DATE_OF_RESERVATION,
    TOURIST, MR_MRS, DATE_OF_BIRTH, PASSPORT, HOTEL, HOTEL_CODE,
    ROOM_CATEGORY, ROOM_CATEGORY_CODE, RATE_CATEGORY, SGL, DBL, TRP,
    TOTAL_NO_OF_PAX, NO_OF_ADULTS, NO_OF_CHILD, NO_OF_INFANTS,
    MEAL, MEAL_PLAN_CODE, FLIGHT_NAME, RETURN_FLIGHT, SERVICES_BY_PARTNER,
    STAY_START_DATE, STAY_END_DATE, FTO_CURRENCY, TAX_INCLUSIVE, FTO_AMOUNT
  FROM TA_CHARTER_BKNG_INTERFACE_TEMP
  WHERE VALIDATION_STATUS = 'Y';






  v_count := SQL%ROWCOUNT;
  COMMIT;
END;



CREATE TABLE TA_CHARTER_BKNG_INTERFACE_TEMP (
    TEMP_ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    UPLOAD_SOURCE VARCHAR2(100),
    VALIDATION_STATUS VARCHAR2(1) DEFAULT 'P',
    ERROR_LOG VARCHAR2(4000),
    UPLOADER_DATE DATE DEFAULT SYSDATE,
    FILE_CODE VARCHAR2(100),
    COSTING_CODE VARCHAR2(100),
    RESERVATION_NO NUMBER,
    DATE_OF_RESERVATION DATE,
    TOURIST VARCHAR2(500),
    MR_MRS VARCHAR2(10),
    DATE_OF_BIRTH DATE,
    PASSPORT VARCHAR2(100),
    HOTEL VARCHAR2(500),
    HOTEL_CODE VARCHAR2(100),
    ROOM_CATEGORY VARCHAR2(200),
    ROOM_CATEGORY_CODE VARCHAR2(100),
    RATE_CATEGORY VARCHAR2(200),
    SGL NUMBER,
    DBL NUMBER,
    TRP NUMBER,
    TOTAL_NO_OF_PAX NUMBER,
    NO_OF_ADULTS NUMBER,
    NO_OF_CHILD NUMBER,
    NO_OF_INFANTS NUMBER,
    MEAL VARCHAR2(200),
    MEAL_PLAN_CODE VARCHAR2(100),
    FLIGHT_NAME VARCHAR2(200),
    RETURN_FLIGHT VARCHAR2(200),
    SERVICES_BY_PARTNER VARCHAR2(500),
    STAY_START_DATE DATE,
    STAY_END_DATE DATE,
    FTO_CURRENCY VARCHAR2(10),
    TAX_INCLUSIVE VARCHAR2(10),
    FTO_AMOUNT NUMBER,
    PRIMARY KEY (TEMP_ID)
);




CREATE INDEX IDX_CHARTER_TEMP_UPLOAD_SRC ON TA_CHARTER_BKNG_INTERFACE_TEMP(UPLOAD_SOURCE);
CREATE INDEX IDX_CHARTER_TEMP_VALIDATION ON TA_CHARTER_BKNG_INTERFACE_TEMP(VALIDATION_STATUS);
